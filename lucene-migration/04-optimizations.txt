# Sanity checks:
# git co master
# git log -1
# diff master against SVN's revision from latest git commit (https://svn.apache.org/repos/asf/lucene/dev/trunk@1720732)
# => lib/ and other empty folders missing
# => file mode differences in a few places (?)
#
# People on windows have to: git config core.filemode false

# Custom version of bfg cleaner!
# Truncates files to 0 bytes, does not remove them from history

# Size of the git repo at this point ~= 455 mb

java -jar ../tools/bfg-1.12.9-SNAPSHOT-master-44191f3-dirty.jar --no-blob-protection -fi "*.jar" -fs 1G --replace-text ../tools/subst.in stitching
git reflog expire --expire=now --all && git gc --prune=now --aggressive

# Size of the git repo at this point ~= 214 mb

# OPTIONAL!

# Remove large historical files, leave in protected branches

java -jar ../tools/bfg-1.12.9-SNAPSHOT-master-44191f3-dirty.jar --protect-blobs-from master,branch_5x,branch_4x,branch_3x -fi "*.mem" -fs 1G --replace-text ../tools/subst.in .
java -jar ../tools/bfg-1.12.9-SNAPSHOT-master-44191f3-dirty.jar --protect-blobs-from master,branch_5x,branch_4x,branch_3x -fi "*.dat" -fs 1G --replace-text ../tools/subst.in .
java -jar ../tools/bfg-1.12.9-SNAPSHOT-master-44191f3-dirty.jar --protect-blobs-from master,branch_5x,branch_4x,branch_3x -fi "*.war" -fs 1G --replace-text ../tools/subst.in .
java -jar ../tools/bfg-1.12.9-SNAPSHOT-master-44191f3-dirty.jar --protect-blobs-from master,branch_5x,branch_4x,branch_3x -fi "*.zip" -fs 1G --replace-text ../tools/subst.in .
git reflog expire --expire=now --all && git gc --prune=now --aggressive

# -> reduces to 163 mb, but at the cost of breaking any past revision which actually used these files.

# remove folders:
solr/site
solr/site-src
lucene/site
src/site

sandbox/projects/appex/?
sandbox/projects/larm/?
sandbox/?
site/*

docs/*

